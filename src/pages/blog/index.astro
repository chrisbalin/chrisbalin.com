---
import Base from '../../layouts/Base.astro';
import { getCollection } from 'astro:content';

const posts = await getCollection('blog');
const sorted = posts.sort((a, b) => b.data.date.getTime() - a.data.date.getTime());
---

<Base title="Blog â€” Chris Balin">
  <header>
    <a href="/" class="text-text-muted hover:text-text text-sm no-underline">&larr; Back</a>
    <h1 class="text-base font-semibold mt-4">Blog</h1>
  </header>

  <main class="mt-8">
    {sorted.length === 0 ? (
      <p class="text-text-muted">Nothing here yet.</p>
    ) : (
      <ul class="space-y-6">
        {sorted.map((post) => (
          <li>
            <a href={`/blog/${post.id}`} class="group no-underline">
              <p class="font-medium group-hover:text-accent">{post.data.title}</p>
              <p class="text-sm text-text-muted mt-1">{post.data.description}</p>
              <time class="text-sm text-text-muted" datetime={post.data.date.toISOString()}>
                {post.data.date.toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' })}
              </time>
            </a>
          </li>
        ))}
      </ul>
    )}
  </main>
</Base>
